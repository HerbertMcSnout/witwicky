Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Loading pytorch/1.1.0
  Loading requirement: cuda/10.0 cudnn/7.4
rm: cannot remove ‘*.best_trans’: No such file or directory
rm: cannot remove ‘*.beam_trans’: No such file or directory
Traceback (most recent call last):
  File "/afs/crc.nd.edu/x86_64_linux/p/pytorch/1.1.0/build/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/afs/crc.nd.edu/x86_64_linux/p/pytorch/1.1.0/build/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/afs/crc.nd.edu/group/nlp/04/cmcdona8/witwicky2/nmt/__main__.py", line 30, in <module>
    trainer.train()
  File "/afs/crc.nd.edu/group/nlp/04/cmcdona8/witwicky2/nmt/train.py", line 200, in train
    self.run_log(b, e, batch_data)
  File "/afs/crc.nd.edu/group/nlp/04/cmcdona8/witwicky2/nmt/train.py", line 106, in run_log
    ret = self.model(src_toks_cuda, src_trees, trg_toks_cuda, targets_cuda) # calls some functions, ends up calling model.forward()
  File "/afs/crc.nd.edu/x86_64_linux/p/pytorch/1.1.0/build/lib/python3.7/site-packages/torch/nn/modules/module.py", line 493, in __call__
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/group/nlp/04/cmcdona8/witwicky2/nmt/model.py", line 122, in forward
    encoder_inputs = self.get_input(src_toks, src_trees)
  File "/afs/crc.nd.edu/group/nlp/04/cmcdona8/witwicky2/nmt/model.py", line 105, in get_input
    assert False, "word_embeds shape: {}; word_embeds type: {}; is cuda: {}; embed_scale: {}".format(word_embeds.size(), word_embeds.dtype, word_embeds.is_cuda, self.embed_scale)
AssertionError: word_embeds shape: torch.Size([149, 27, 512]); word_embeds type: torch.float32; is cuda: True; embed_scale: 22.627416997969522
