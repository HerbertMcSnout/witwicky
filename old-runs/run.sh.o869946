Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Loading pytorch/1.1.0
  Loading requirement: cuda/10.0 cudnn/7.4
Traceback (most recent call last):
  File "/afs/crc.nd.edu/x86_64_linux/p/pytorch/1.1.0/build/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/afs/crc.nd.edu/x86_64_linux/p/pytorch/1.1.0/build/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/afs/crc.nd.edu/group/nlp/04/cmcdona8/witwicky2/nmt/__main__.py", line 30, in <module>
    trainer.train()
  File "/afs/crc.nd.edu/group/nlp/04/cmcdona8/witwicky2/nmt/train.py", line 200, in train
    self.run_log(b, e, batch_data)
  File "/afs/crc.nd.edu/group/nlp/04/cmcdona8/witwicky2/nmt/train.py", line 106, in run_log
    ret = self.model(src_toks_cuda, src_trees, trg_toks_cuda, targets_cuda) # calls some functions, ends up calling model.forward()
  File "/afs/crc.nd.edu/x86_64_linux/p/pytorch/1.1.0/build/lib/python3.7/site-packages/torch/nn/modules/module.py", line 493, in __call__
    result = self.forward(*input, **kwargs)
  File "/afs/crc.nd.edu/group/nlp/04/cmcdona8/witwicky2/nmt/model.py", line 121, in forward
    encoder_inputs = self.get_input(src_toks, src_trees)
  File "/afs/crc.nd.edu/group/nlp/04/cmcdona8/witwicky2/nmt/model.py", line 111, in get_input
    pos_embeds = torch.stack([tree.get_pos_embedding(self.pos_embedding_mu_l, self.pos_embedding_mu_r, self.pos_embedding_lambda, toks.size()[-1], self.config['embed_dim']) for tree in trees]) # [bsz, max_len, embed_dim]
  File "/afs/crc.nd.edu/group/nlp/04/cmcdona8/witwicky2/nmt/model.py", line 111, in <listcomp>
    pos_embeds = torch.stack([tree.get_pos_embedding(self.pos_embedding_mu_l, self.pos_embedding_mu_r, self.pos_embedding_lambda, toks.size()[-1], self.config['embed_dim']) for tree in trees]) # [bsz, max_len, embed_dim]
  File "/afs/crc.nd.edu/group/nlp/04/cmcdona8/witwicky2/nmt/tree.py", line 83, in get_pos_embedding
    assert False, "This is a test"
AssertionError: This is a test
inside norm is 1.0455873012542725
inside norm is 1.0431891679763794
inside norm is 1.0455873012542725
inside norm is 1.0431891679763794
inside norm is 1.0511541366577148
inside norm is 1.0455873012542725
inside norm is 1.1234267950057983
inside norm is 1.1762956380844116
inside norm is 1.227160930633545
inside norm is 1.1907519102096558
inside norm is 1.3059524297714233
outside norm is 1.1920045614242554
outside norm is 1.2656409740447998
outside norm is 1.4122463464736938
outside norm is 1.3563867807388306
outside norm is 1.3883031606674194
outside norm is 1.3285075426101685
outside norm is 1.308774471282959
outside norm is 1.2756319046020508
outside norm is 1.3706907033920288
outside norm is 1.2873834371566772
outside norm is 1.2952969074249268
outside norm is 1.1899365186691284
outside norm is 1.2862942218780518
outside norm is 1.3150793313980103
outside norm is 1.2507164478302002
outside norm is 1.0879240036010742
outside norm is 1.1025575399398804
outside norm is 1.0398645401000977
outside norm is 1.348785161972046
outside norm is 1.0619761943817139
outside norm is 1.366227626800537
outside norm is 1.0529485940933228
outside norm is 1.0252267122268677
